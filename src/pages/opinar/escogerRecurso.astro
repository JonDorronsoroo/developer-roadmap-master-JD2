---
import SimplePageHeader from "../../components/SimplePageHeader.astro";
import { getAllRecursos, getRecursoById } from "../../database/consultas";
import BaseLayout from "../../layouts/BaseLayout.astro";
import '../../styles/formulario.css'


 export const prerender = false

 const recursos = await getAllRecursos();

 if(Astro.request.method === 'POST'){
  try{
    const data = await Astro.request.formData();
    const recurso = data.get('recurso')?.toString();
    const id = parseInt(recurso || '0');

    const elegido = await getRecursoById(id);
    if(elegido?.interno){
      return Astro.redirect('/enviarOpinionInterno?id=${id}');
    }else{  
      return Astro.redirect('/enviarOpinionExternoid=${id}');

    }


  }catch(error){
    console.log(error);
  }
}


---



<BaseLayout title='Onboarding' permalink={'/enviarOpinion'}>
    <SimplePageHeader
    title='Developer Roadmaps'
    description='En LKS Next, estamos comprometidos con el crecimiento profesional y el desarrollo de habilidades de nuestro equipo. Como parte de este compromiso, ofrecemos una variedad de recursos de aprendizaje, tanto internos como externos, incluyendo cursos y talleres diseñados para enriquecer su conocimiento y competencias. Nos gustaría conocer su opinión sobre estos recursos: si han sido útiles para desempeñar su rol dentro del equipo y para llevar a cabo sus tareas de manera efectiva. Su feedback es invaluable para nosotros, ya que nos permite evaluar y mejorar constantemente la calidad y la relevancia de las oportunidades de aprendizaje que ofrecemos.'
  />


  <form method="POST">
    <fieldset>
        <legend>LKS Evaluación de recursos de aprendizaje</legend>
        <label for="titulo">Escoge el recurso que has cursado:</label>
        <select id="recurso" name="recurso" required>
          <option value="" disabled selected>Escoger el recurso a valorar...</option>
          {recursos?.map((recurso) => {
            <option value={recurso.idRecurso}>{recurso.titulo}</option>
        })}
        
        </select>

</fieldset>

      <button type="submit">Next</button>

  </form>

</BaseLayout>