---
import SimplePageHeader from "../../components/SimplePageHeader.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import '../../styles/formulario.css'
import {insertResource} from '../../database/consultas.ts'

 export const prerender = false

 if (Astro.request.method === "POST") {
    try {
        const data = await Astro.request.formData();
      const titulo = data.get("titulo");
      const enlace = data.get("enlaceFichero");
      const interno = data.get("internoExterno");
      //Opcionales
      const descripcion = data.get("descripcion");
      const dificultad = data.get("dificultad");
      const idioma = data.get("idioma");
        const tipo = data.get("tipo");
        const formato = data.get("formato");
      let idRecurso ;
      
      idRecurso = await insertResource(titulo, enlace, interno, descripcion ?? null , dificultad ?? null, idioma ?? null, tipo ?? null, formato ?? null, null);

    } catch (error) {
      console.log(error);
    }
  }
---


<BaseLayout title='Onboarding' permalink={'/enviarOpinion'}>
    <SimplePageHeader
    title='Developer Roadmaps'
    description='Incluir en el almacenamiento de la empresa un nuevo recurso:'
  />

  <form method="POST">
    <fieldset>
        <label  for="titulo" >Título:</label>
        <input
          type="text"
          id="titulo"
          name="titulo"
          required
          placeholder="Título del recurso" aria-required="true"
        />

        <label for="enlaceFichero">Enlace al fichero:</label>
        <input
          type="text"
          id="enlaceFichero"
          name="enlaceFichero"
          required
          placeholder="Enlace del fichero" aria-required="true"
        />

        <label for="interno">¿Este recurso ha sido creado por LKS?:</label>
            <div class="radio-container" >
                <input type="radio" id="interno" name="internoExterno" value={true} required>
                <label for="interno">Sí</label>

                <input type="radio" id="externo" name="internoExterno" value={false} required>
                <label for="intermedio">No</label>
              </div>
        </fieldset>


        <fieldset>
            <legend>Campos opcionales </legend>
            <br>
        <label for="descripcion">Descripción:</label>
        <textarea
          id="descripcion"
          name="descripcion"
          cols="50"
          rows="5"
          placeholder="Descripción..."
        ></textarea>
        

        <label for="dificultad">Nivel de dificultad:</label>

            <div class="radio-container">
                <input type="radio" id="principiante" name="dificultad" value="principiante">
                <label for="principiante">Principiante</label>
                
                <input type="radio" id="intermedio" name="dificultad" value="intermedio">
                <label for="intermedio">Intermedio</label>
                
                <input type="radio" id="avanzado" name="dificultad" value="avanzado">
                <label for="avanzado">Avanzado</label>
              </div>

        <label for="idioma">Idioma:</label>
              <select id="idioma" name="idioma" >
                <option value="" disabled selected>Escoger idioma...</option>
                <option value="castellano">Castellano</option>
                <option value="euskera">Euskera</option>
                <option value="ingles">Inglés</option>
                <option value="otro">Otro...</option>
              </select>

        <label for="tipo">¿Qué tipo es?:</label>
              <select id="tipo" name="tipo" >
                <option value="" disabled selected>Escoger tipo...</option>
                <option value="dePago">Curso de pago</option>
                <option value="gratuito">Curso gratuito</option>
                <option value="webinars">Webinars</option>
                <option value="libro">Libro</option>
                <option value="guia">Guía</option>
                <option value="tutorial">Tutorial</option>
                <option value="articulo">Artículo</option>
                <option value="otro">Otro...</option>
              </select>

              <label for="formato">¿Qué formato tiene?:</label>
              <select id="formato" name="formato" >
                <option value="" disabled selected>Escoger formato...</option>
                <option value="pdf">PDF</option>
                <option value="video">Vídeo</option>
                <option value="imagen">Imagen</option>
                <option value="presentacion">Presentación</option>
                <option value="otro">Otro...</option>
              </select>


            </fieldset>

            <label for="otrosRecursos">¿Esta relacionado con algún otro?:</label>
            Falta implementar esto, permiter mostrar la lista de recursos,
            y seleccionar uno o varios de ellos para relacionarlos con el nuevo recurso.

        <button type="submit">Guardar</button>

</form>


</BaseLayout>